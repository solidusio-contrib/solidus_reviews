var reviewElement = document.querySelector('[data-review-id="<%= @review.id %>"]');

var positiveCountElement = reviewElement.querySelector('.positive-count');
var negativeCountElement = reviewElement.querySelector('.negative-count');

var thumbUpButton = reviewElement.querySelector('.thumb-up-btn');
var thumbDownButton = reviewElement.querySelector('.thumb-down-btn');
var flagReportButton = reviewElement.querySelector('.flag-review-btn');

var thumbUpSvg = thumbUpButton.querySelector('use');
var thumbDownSvg = thumbDownButton.querySelector('use');
var flagReportSvg = flagReportButton.querySelector('use');

positiveCountElement.textContent = "<%= @review.positive_count %>";
negativeCountElement.textContent = "<%= @review.negative_count %>";

var userVotedPositive = "<%= Spree::ReviewVote.user_voted?(@review, Spree::ReviewVote::POSITIVE, spree_current_user) %>" === "true";
var userVotedNegative = "<%= Spree::ReviewVote.user_voted?(@review, Spree::ReviewVote::NEGATIVE, spree_current_user) %>" === "true";
var userVotedReport = "<%= Spree::ReviewVote.user_voted?(@review, Spree::ReviewVote::REPORT, spree_current_user) %>" === "true";

flagReportButton.toggleAttribute('disabled', userVotedReport);
thumbUpButton.querySelector('svg').classList.toggle('fill-primary', userVotedPositive);
thumbDownButton.querySelector('svg').classList.toggle('fill-primary', userVotedNegative);
flagReportButton.querySelector('svg').classList.toggle('fill-primary', userVotedReport);


document.getElementById('flagReviewModal<%= @review.id %>').classList.add('hidden');

thumbUpSvg.setAttribute('xlink:href',
  "<%= image_path('remixicon.symbol.svg') %>#ri-thumb-up-" + (userVotedPositive ? 'fill' : 'line')
);

thumbDownSvg.setAttribute('xlink:href',
  "<%= image_path('remixicon.symbol.svg') %>#ri-thumb-down-" + (userVotedNegative ? 'fill' : 'line')
);

flagReportSvg.setAttribute('xlink:href',
  "<%= image_path('remixicon.symbol.svg') %>#ri-flag-" + (userVotedReport ? 'fill' : 'line')
);
